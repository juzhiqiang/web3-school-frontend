# 一灯币兑换功能

## 概述

新增了一灯币(YiDeng Token)与ETH的双向兑换功能，用户可以便捷地进行代币买卖交易。

## 功能特性

### 🔄 双向兑换
- **购买一灯币**: 使用ETH购买一灯币
- **出售一灯币**: 将一灯币兑换为ETH

### 💰 智能定价
- 实时显示当前兑换率
- 自动计算手续费
- 支持滑点保护

### 🛡️ 安全保障
- 合约级别的重入攻击保护
- 用户授权机制
- 余额验证
- 滑点容差设置

### 📊 实时数据
- 用户余额显示
- 流动性池状态
- 交易历史追踪

## 合约信息

- **合约地址**: `0x5b8721Cbe813d85706536c08a08e97f3Cc81BFa0`
- **代币符号**: YD (一灯币)
- **小数位数**: 18
- **默认手续费**: 买入1% / 卖出1%

## 使用流程

### 购买一灯币
1. 连接钱包
2. 选择"购买一灯币"模式
3. 输入要支付的ETH数量
4. 确认交易详情
5. 点击"购买一灯币"按钮
6. 在钱包中确认交易

### 出售一灯币
1. 连接钱包
2. 选择"出售一灯币"模式
3. 输入要出售的YD数量
4. 首次需要授权代币使用
5. 确认交易详情
6. 点击"出售一灯币"按钮
7. 在钱包中确认交易

## 技术实现

### 新增文件
- `src/hooks/useTokenSwap.ts` - 代币兑换逻辑hook
- `src/pages/TokenSwap/TokenSwap.tsx` - 兑换页面组件
- `src/config/tokenSwap.ts` - 配置常量

### 修改文件
- `src/App.tsx` - 添加路由配置
- `src/components/Layout/Header.tsx` - 添加导航链接
- `src/pages/Financial/Financial.tsx` - 集成代币余额显示和快速入口

### 主要依赖
- `wagmi` - Web3 React hooks
- `viem` - 以太坊工具库
- `react-hot-toast` - 用户通知

## 配置说明

### 环境变量
确保在`.env`文件中配置了必要的环境变量：
```
VITE_WALLET_CONNECT_PROJECT_ID=your-project-id
```

### 支持网络
- Ethereum Mainnet (Chain ID: 1)
- Sepolia Testnet (Chain ID: 11155111)

## 安全注意事项

1. **授权管理**: 出售代币前需要授权合约，建议只授权当前交易所需的金额
2. **滑点设置**: 根据市场波动情况合理设置滑点容差
3. **Gas费用**: 所有交易都需要支付以太坊网络的gas费用
4. **交易确认**: 交易提交后需要等待区块确认才能完成

## 错误处理

系统包含完善的错误处理机制：
- 余额不足检查
- 网络连接验证
- 交易失败重试
- 用户友好的错误提示

## 未来扩展

可考虑添加的功能：
- 交易历史记录
- 价格图表
- 流动性挖矿
- 多代币兑换支持
- 批量交易功能
